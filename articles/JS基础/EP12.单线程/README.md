# 单线程

## 什么是单线程

单线程即是, 进程只有一个线程, 在同一时间内, 永远只做一件事.

按照执行队列一条条的执行任务.

而单线程就是 Javascript 的一大特点,

## 为什么是单线程?

这样设计的原因是, Javascript 的设计初衷就是一门客户端语言, 主要用于跟用户打交道, 比如表单校验.

从服务对象上来说, 只有一个, 那就是用户, 不像服务端需要服务成千上万的用户.

而对于用户来说, 也是只能做一件事, 鼠标只能点击一个按钮.

总结一下就是, 技术的发展也是跟使用场景结合的. 因为没有多线程的需要. 所以单线程就够了.

其实还有一点就是, Javascript 经常用来操作 DOM, 如果多个线程同时操作一个 DOM 这个会涉及到资源竞争.

类似于数据的操作一样, 到时候势必会引入类似于**悲观锁**, **乐观锁**的概念, 会导致`Javascript`被设计的很复杂, 很臃肿, 这是
一门客户端语言, size 的大小也是很重要的. 所以综合考虑, 还是单线程简单方便.

## 事件循环

在设计中, 也使用了 事件循环(`Event loop`) 对任务进行了分配和调控, 使不管是异步任务还是同步任务都能在任务栈中运行.

但纵使是宏任务(`macrotask`), 微任务`microtask`, 都只是放在各自队列中, 最终执行的只有其中的一个任务.

## 单线程的缺点

当主进程被keep住的时候, 一直被使用的时候, 用户的操作会得不到反馈,
比如用户的点击事件, 不会有结果.

```javascript
setTimeout(() => {
  console.log('setTimeout')
}, 0)
```
如上实例, 因为`setTimeout`是宏任务, 当时间到了之后, 它的回调是被推到宏任务队列中, 而不是立即执行, 当该任务之前的宏任务都被执行完成之后才会执行当前回调.
